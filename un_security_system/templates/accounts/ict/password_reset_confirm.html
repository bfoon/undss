<!-- FILE 1: templates/accounts/password_reset_confirm.html -->
{% extends "base.html" %}
{% block title %}Set New Password{% endblock %}

{% block content %}
<div class="container py-5" style="max-width:600px;">
  <div class="text-center mb-4">
    <i class="bi bi-key-fill text-primary" style="font-size: 3rem;"></i>
    <h2 class="mt-3">Set New Password</h2>
    <p class="text-muted">Enter your new password below</p>
  </div>

  <div class="card shadow-sm">
    <div class="card-body p-4">
      {% if validlink %}
        <form method="post">
          {% csrf_token %}

          {% if form.errors %}
            <div class="alert alert-danger">
              <i class="bi bi-exclamation-triangle-fill me-2"></i>
              Please correct the errors below.
            </div>
          {% endif %}

          <div class="mb-3">
            <label for="{{ form.new_password1.id_for_label }}" class="form-label fw-semibold">
              New Password <span class="text-danger">*</span>
            </label>
            {{ form.new_password1 }}
            {% if form.new_password1.errors %}
              <div class="invalid-feedback d-block">
                {{ form.new_password1.errors.0 }}
              </div>
            {% endif %}
            {% if form.new_password1.help_text %}
              <small class="form-text text-muted d-block mt-1">
                {{ form.new_password1.help_text }}
              </small>
            {% endif %}
          </div>

          <div class="mb-4">
            <label for="{{ form.new_password2.id_for_label }}" class="form-label fw-semibold">
              Confirm Password <span class="text-danger">*</span>
            </label>
            {{ form.new_password2 }}
            {% if form.new_password2.errors %}
              <div class="invalid-feedback d-block">
                {{ form.new_password2.errors.0 }}
              </div>
            {% endif %}
          </div>

          <div class="alert alert-info small">
            <strong>Password Requirements:</strong>
            <ul class="mb-0 mt-2">
              <li>At least 8 characters long</li>
              <li>Cannot be entirely numeric</li>
              <li>Cannot be too similar to your personal information</li>
            </ul>
          </div>

          <button type="submit" class="btn btn-primary w-100">
            <i class="bi bi-check-circle me-1"></i> Set Password
          </button>
        </form>
      {% else %}
        <div class="alert alert-danger">
          <i class="bi bi-exclamation-triangle-fill me-2"></i>
          <strong>Invalid or Expired Link</strong>
          <p class="mb-0 mt-2">
            This password reset link is invalid or has already been used.
            Please request a new password reset link.
          </p>
        </div>
        <a href="{% url 'accounts:login' %}" class="btn btn-primary w-100">
          <i class="bi bi-box-arrow-in-right me-1"></i> Return to Login
        </a>
      {% endif %}
    </div>
  </div>
</div>

<style>
  .form-control { border-color: #dee2e6; }
  .form-control:focus { border-color: #86b7fe; box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25); }
  .form-control.is-invalid { border-color: #dc3545; }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.invalid-feedback').forEach(function(feedback) {
      const formControl = feedback.previousElementSibling;
      if (formControl && formControl.classList.contains('form-control')) {
        formControl.classList.add('is-invalid');
      }
    });
  });
</script>
{% endblock %}


<!-- FILE 2: templates/accounts/password_reset_complete.html -->
{% extends "base.html" %}
{% block title %}Password Reset Complete{% endblock %}

{% block content %}
<div class="container py-5" style="max-width:600px;">
  <div class="text-center">
    <div class="mb-4">
      <i class="bi bi-check-circle-fill text-success" style="font-size: 4rem;"></i>
    </div>

    <h2 class="mb-3">Password Reset Complete</h2>
    <p class="text-muted mb-4">
      Your password has been set successfully. You can now log in with your new password.
    </p>

    <a href="{% url 'accounts:login' %}" class="btn btn-primary btn-lg">
      <i class="bi bi-box-arrow-in-right me-2"></i> Go to Login
    </a>
  </div>
</div>
{% endblock %}


<!-- FILE 3: templates/accounts/password_reset_done.html -->
{% extends "base.html" %}
{% block title %}Password Reset Email Sent{% endblock %}

{% block content %}
<div class="container py-5" style="max-width:600px;">
  <div class="text-center">
    <div class="mb-4">
      <i class="bi bi-envelope-check-fill text-info" style="font-size: 4rem;"></i>
    </div>

    <h2 class="mb-3">Check Your Email</h2>
    <p class="text-muted mb-4">
      We've sent you instructions for resetting your password to the email address you submitted.
      You should receive them shortly.
    </p>

    <div class="alert alert-info">
      <i class="bi bi-info-circle-fill me-2"></i>
      If you don't receive an email, please make sure you've entered the correct address
      and check your spam folder.
    </div>

    <a href="{% url 'accounts:login' %}" class="btn btn-outline-primary">
      <i class="bi bi-arrow-left me-1"></i> Back to Login
    </a>
  </div>
</div>
{% endblock %}


<!-- FILE 4: templates/accounts/password_reset.html -->
{% extends "base.html" %}
{% block title %}Reset Password{% endblock %}

{% block content %}
<div class="container py-5" style="max-width:600px;">
  <div class="text-center mb-4">
    <i class="bi bi-key text-primary" style="font-size: 3rem;"></i>
    <h2 class="mt-3">Reset Password</h2>
    <p class="text-muted">Enter your email address to receive password reset instructions</p>
  </div>

  <div class="card shadow-sm">
    <div class="card-body p-4">
      <form method="post">
        {% csrf_token %}

        {% if form.errors %}
          <div class="alert alert-danger">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            {{ form.errors }}
          </div>
        {% endif %}

        <div class="mb-4">
          <label for="{{ form.email.id_for_label }}" class="form-label fw-semibold">
            Email Address <span class="text-danger">*</span>
          </label>
          {{ form.email }}
          {% if form.email.errors %}
            <div class="invalid-feedback d-block">
              {{ form.email.errors.0 }}
            </div>
          {% endif %}
          <small class="form-text text-muted">
            Enter the email address associated with your account
          </small>
        </div>

        <button type="submit" class="btn btn-primary w-100 mb-3">
          <i class="bi bi-envelope me-1"></i> Send Reset Instructions
        </button>

        <div class="text-center">
          <a href="{% url 'accounts:login' %}" class="text-decoration-none">
            <i class="bi bi-arrow-left me-1"></i> Back to Login
          </a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}